library(tidyverse)

bcs <- read_csv("input_data/6891_F1.csv") %>%
       transmute(
           case_id = rowlabel,
           sex = recode(sex, `1` = "M", `2` = "F"),
           age,
           marital_status = recode(livharm1, `1` = "Married",
                                             `2` = "Cohabiting",
                                             `3` = "Single",
                                             `4` = "Separated",
                                             `5` = "Divorced",
                                             `6` = "Widowed"),
           ethnic_origin = recode(ethgrp2, `1` = "White",
                                           `2` = "Mixed",
                                           `3` = "Asian or Asian British",
                                           `4` = "Black or Black British",
                                           `5` = "Chinese or Other"),
           education = recode(educat3, `1` = "None",
                                       `2` = "O Level / GCSE",
                                       `3` = "Apprenticeship or A/AS Level",
                                       `4` = "Degree or Diploma",
                                       `5` = "Other"),
           paid_work_last_wk = (work == 1),
           years_in_area = recode(yrsarea, `1` = "[0, 1)",
                                           `2` = "[1, 2)",
                                           `3` = "[2, 3)",
                                           `4` = "[3, 5)",
                                           `5` = "[5, 10)",
                                           `6` = "[10, 20)",
                                           `7` = "[20, Inf)"),
           same_address_last_year = (resyrago == 1),
           tenure = recode(tenure1, `1` = "Own outright",
                                    `2` = "Buying with mortgage/loan",
                                    `3` = "Shared ownership",
                                    `4` = "Rent",
                                    `5` = "Live rent-free"),
           rural_area = (rural2 == 2),
           litter = recode(rubbcomm, `1` = "Very common",
                                     `2` = "Fairly common",
                                     `3` = "Not very common",
                                     `4` = "Not at all common"),
           vandalism = recode(vandcomm, `1` = "Very common",
                                        `2` = "Fairly common",
                                        `3` = "Not very common",
                                        `4` = "Not at all common"),
           rundown_houses = recode(poorhou, `1` = "Very common",
                                            `2` = "Fairly common",
                                            `3` = "Not very common",
                                            `4` = "Not at all common"),
           deprivation_index = if_else(is.na(tcemdiqu2), tcwmdiqu2, tcemdiqu2),
           main_cause = recode(causem, `1` = "Too lenient sentencing",
                                       `2` = "Poverty",
                                       `3` = "Lack of discipline from school",
                                       `4` = "Lack of discipline from parents",
                                       `5` = "Drugs",
                                       `6` = "Alcohol",
                                       `7` = "Unemployment",
                                       `8` = "Breakdown of family",
                                       `9` = "Too few police",
                                       `10` = "Spontaneous"),
           safety_home_night = recode(homealon, `1` = "Very safe",
                                                `2` = "Fairly safe",
                                                `3` = "A bit unsafe",
                                                `4` = "Very unsafe"),
           safety_walk_night = recode(walkdark, `1` = "Very safe",
                                                `2` = "Fairly safe",
                                                `3` = "A bit unsafe",
                                                `4` = "Very unsafe"),
           safety_walk_day = recode(walkday, `1` = "Very safe",
                                             `2` = "Fairly safe",
                                             `3` = "A bit unsafe",
                                             `4` = "Very unsafe"),
           worry_burglary = recode(wburgl, `1` = "Very worried",
                                           `2` = "Fairly worried",
                                           `3` = "Not very worried",
                                           `4` = "Not at all worried"),
           worry_robbery = recode(wmugged, `1` = "Very worried",
                                           `2` = "Fairly worried",
                                           `3` = "Not very worried",
                                           `4` = "Not at all worried"),
           worry_car_theft = recode(wcarstol, `1` = "Very worried",
                                              `2` = "Fairly worried",
                                              `3` = "Not very worried",
                                              `4` = "Not at all worried"),
           worry_theft_from_car = recode(wfromcar, `1` = "Very worried",
                                                   `2` = "Fairly worried",
                                                   `3` = "Not very worried",
                                                   `4` = "Not at all worried"),
           worry_rape = recode(wraped, `1` = "Very worried",
                                       `2` = "Fairly worried",
                                       `3` = "Not very worried",
                                       `4` = "Not at all worried"),
           worry_assault = recode(wattack, `1` = "Very worried",
                                           `2` = "Fairly worried",
                                           `3` = "Not very worried",
                                           `4` = "Not at all worried"),
           worry_insult = recode(winsult, `1` = "Very worried",
                                          `2` = "Fairly worried",
                                          `3` = "Not very worried",
                                          `4` = "Not at all worried"),
           worry_racism = recode(wraceatt, `1` = "Very worried",
                                           `2` = "Fairly worried",
                                           `3` = "Not very worried",
                                           `4` = "Not at all worried"),
           crime_change_two_yrs = recode(crimerat, `1` = "A lot more crime",
                                                   `2` = "A little more crime",
                                                   `3` = "About the same",
                                                   `4` = "A little less crime",
                                                   `5` = "A lot less crime"),
           personal_crime = tcviolent,
           property_crime = tcsteal,
           antisocial_behaviour = tcarea,
           nuisance_neighbours = tcneigh,
           victim_last_yr = (bcsvictim == 1)
       )

write_csv(bcs, "bcs.csv")

