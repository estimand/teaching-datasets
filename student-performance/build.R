library(tidyverse)

por <- read_csv2("input_data/student-por.csv") %>%
       transmute(
           school = recode(school, "GP" = "Gabriel Pereira", "MS" = "Mouzinho da Silveira"),
           sex,
           age,
           home_area = recode(address, "U" = "Urban", "R" = "Rural"),
           family_size = recode(famsize, "LE3" = "<= 3", "GT3" = "> 3"),
           parents_cohabit = Pstatus == "T",
           education_mother = recode(Medu, `0` = "None",
                                           `1` = "Primary education",
                                           `2` = "Lower secondary education",
                                           `3` = "Upper secondary education",
                                           `4` = "Higher education"),
           education_father = recode(Fedu, `0` = "None",
                                           `1` = "Primary education",
                                           `2` = "Lower secondary education",
                                           `3` = "Upper secondary education",
                                           `4` = "Higher education"),
           occupation_mother = recode(Mjob, "teacher" = "Teacher",
                                            "health" = "Healthcare",
                                            "services" = "Civil service",
                                            "at_home" = "At home",
                                            "other" = "Other"),
           occupation_father = recode(Fjob, "teacher" = "Teacher",
                                            "health" = "Healthcare",
                                            "services" = "Civil service",
                                            "at_home" = "At home",
                                            "other" = "Other"),
           reason = recode(reason, "home" = "Close to home",
                                   "reputation" = "Reputation",
                                   "course" = "Course preference",
                                   "other" = "Other"),
           guardian = recode(guardian, "mother" = "Mother",
                                       "father" = "Father",
                                       "other" = "Other"),
           travel_time = recode(traveltime, `1` = "< 15 minutes",
                                            `2` = "15 to 30 minutes",
                                            `3` = "30 minutes to 1 hour",
                                            `4` = "> 1 hour"),
           study_time = recode(studytime, `1` = "< 2 hours/week",
                                          `2` = "2 to 5 hours/week",
                                          `3` = "5 to 10 hours/week",
                                          `4` = "> 10 hours/week"),
           failures = recode(failures, `0` = "0",
                                       `1` = "1",
                                       `2` = "2",
                                       `3` = ">= 3"),
           failures,
           extra_school_support = schoolsup == "yes",
           family_support = famsup == "yes",
           extra_tutoring = paid == "yes",
           extracurricular_activities = activities == "yes",
           nursery = nursery == "yes",
           higher_education = higher == "yes",
           internet_access = internet == "yes",
           romantic_relationship = romantic == "yes",
           family_relationships_quality = famrel,
           free_time = freetime,
           going_out = goout,
           alcohol_weekdays = Dalc,
           alcohol_weekend = Walc,
           health_status = health,
           absences,
           final_grade = G3
       )

write_csv(por, "student_performance.csv")

